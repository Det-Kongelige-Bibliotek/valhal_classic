<style>
    h1, h2 {
        text-align: center;
        font-weight: normal;
    }
    #features {
        margin: auto;
        width: 460px;
        font-size: 0.9em;
    }
    .connected, .sortable, .exclude, .handles {
        margin: auto;
        padding: 0;
        width: 310px;
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
    }
    .sortable.grid {
        overflow: hidden;
    }
    .connected li, .sortable li, .exclude li, .handles li {
        list-style: none;
        border: 1px solid #CCC;
        background: #F6F6F6;
        font-family: "Tahoma";
        color: #1C94C4;
        margin: 5px;
        padding: 5px;
        height: 22px;
    }
    .handles span {
        cursor: move;
    }
    li.disabled {
        opacity: 0.5;
    }
    .sortable.grid li {
        line-height: 80px;
        float: left;
        width: 100px;
        height: 100px;
        text-align: center;
    }
    li.highlight {
        background: #FEE25F;
    }
    /*#connected {
        width: 440px;
        overflow: hidden;
        margin: auto;
    }
    .connected {
        float: left;
        width: 200px;
    }
    .connected.no2 {
        float: right;
    }*/
    li.sortable-placeholder {
        border: 1px dashed #CCC;
        background: none;
    }
</style>
<script>
    $(function() {
        $('.sortable').sortable();
        $('.handles').sortable({
            handle: 'span'
        });
        $('.sortable').sortable().bind('sortupdate', function() {
            var test_val = $('#structmap_file_list').find('li').filter(function() {
                return $(this).find('ul').length === 0;
            }).map(function(i, e){
                        return $(this).text();
                    }).get();
            $('#structmap_file_order').val(test_val);
            alert($('#structmap_file_order').val());
        });
        /*$('.connected').sortable({
            connectWith: '.connected'
        });
        $('.exclude').sortable({
            items: ':not(.disabled)'
        });*/
    });
</script>

<h1>Sort TIFFs</h1>

<ul id="structmap_file_list" class="sortable grid">
    <%- @book.tif.first.files.each do |file| %>
        <% # TODO fix the following %>
        <li><%= file.nil? ? "No file" : file.original_filename.chomp(".tif") %></li>
    <%- end %>
</ul>
<%= form_tag(create_structmap_book_path(@book.pid), :method => "put") do %>
    <%= hidden_field_tag("structmap_file_order") %>
  <div class="btn btn-small actions">
    <%= submit_tag("Generate Structmap") %>
  </div>
<%#=  link_to 'Save', wizard_path(:create_structmap)  %>
<% end %>