<%= javascript_include_tag params[:controller] %>
<script type="text/javascript">
    $(document).ready(function(){
        $('.combobox').combobox();
        $('.combobox').click(function(){
            $(this).siblings('.dropdown-toggle').click();
        });
    });
</script>
<div class="control-group">
  <h3>Persons:</h3>
  <%= f.label :agent, 'This work...', :class=>'control-label' %>
  <div class="controls">
    <select id="person_relationship" name="person_relationship" class="control-group">
      <% METADATA_RELATIONS_CONFIG['work']['person'].split(' ').each do |relation|  %>
          <option id="<%= relation %>"><%= relation %></option>
      <% end %>
    </select>
  </div>
  <div class="controls">
      <select class="combobox form-control input-large dropdown-toggle" id="person_id" name="person[id]">
        <option></option>
        <%
           results = ActiveFedora::SolrService.query("#{Person.solr_names[:amu_value]}:* && active_fedora_model_ssi:Person",
                                                     {:rows => ActiveFedora::SolrService.count("#{Person.solr_names[:amu_value]}:* && active_fedora_model_ssi:Person")})
           results.each do |person|  %>
            <option value="<%= person["id"]%>"><%= person["amu_value_ssi"] %></option>
        <% end %>
      </select>
  </div><br/>
  <div class="controls">
    <%= button_tag(type: 'button', onclick: 'addAgent($("#person_relationship option:selected").text(),
                                                    $("#person_id option:selected").text(), $("#person_id option:selected").val())', class: 'btn') do
      content_tag(:label, 'Add Person')
    end
    %>
  </div>
  <p></p>
  <h3>Places:</h3>
  <%= f.label :agent, 'This work...', :class=>'control-label' %>
  <div class="controls">
    <option></option>
    <select id="place_relationship" name="place_relationship" class="control-group">
      <% METADATA_RELATIONS_CONFIG['work']['place'].split(' ').each do |relation|  %>
          <option id="<%= relation %>"><%= relation %></option>
      <% end %>
    </select>
  </div>
  <div class="controls">
    <select class="combobox form-control input-large dropdown-toggle" id="place_id" name="place[id]">
      <%
         results = ActiveFedora::SolrService.query("#{Place.solr_names[:amu_value]}:* && active_fedora_model_ssi:Place",
                                                   {:rows => ActiveFedora::SolrService.count("#{Place.solr_names[:amu_value]}:* && active_fedora_model_ssi:Place")})
         results.each do |place| %>
          <option value="<%= place["id"]%>"><%= place["amu_value_ssi"] %></option>
      <% end %>
    </select>
  </div><br/>
  <div class="controls">
    <%= button_tag(type: 'button', onclick: 'addAgent($("#place_relationship option:selected").text(),
                                                    $("#place_id option:selected").text(), $("#place_id option:selected").val())', class: 'btn') do
      content_tag(:label, 'Add Place')
    end
    %>
  </div>
  <%= hidden_field_tag 'work_agents' %>
  <br><br>
  <div id="work_agents" class="control-group">
    <table border="1" id="agent_relations" class="table">
      <thead>
      <tr>
        <th>Relationship Type</th>
        <th>Agent Name</th>
      </tr>
      </thead>
      <tbody id="agent_relations_tbody">
      <tr>
        <td>None</td>
        <td>None</td>
      </tr>
      </tbody>
    </table>
  </div><br>
</div>
